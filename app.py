"""
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•â•â•â•â•      â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• 

ğŸ¬ MAZARI YOUTUBE UPLOADER PRO - Ù¾ÛŒØ´Û ÙˆØ±Ø§Ù†Û ÙˆÛŒÚˆÛŒÙˆ Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯ Ù¾Ù„ÛŒÙ¹ ÙØ§Ø±Ù…
ğŸ“§ ÚˆÙˆÛŒÙ„Ù¾Ø±: Ø´Ø§ÛØ¯ Ø§Ø­Ù…Ø¯ Ù…Ø²Ø§Ø±ÛŒ | ğŸ“± ÙˆÙ¹Ø³ Ø§ÛŒÙ¾: 03326179672 | âœ‰ï¸ Ø§ÛŒ Ù…ÛŒÙ„: shahidahmadmazari@gmail.com
"""

import streamlit as st
import requests
import random
import os
import json
import time
import hashlib
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
from datetime import datetime, timedelta
from pathlib import Path
import mimetypes
from PIL import Image
import io
import base64
from streamlit_lottie import st_lottie
import logging

# ==================== ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¢ØºØ§Ø² ====================
# Ù„Ø§Ú¯Ù†Ú¯ Ú©Ø§ Ù†Ø¸Ø§Ù…
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('mazari_uploader.log'),
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

# ÚˆÙˆÛŒÙ„Ù¾Ø± Ú©ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª - Ù…Ø±Ú©Ø²ÛŒ ØªØ´ÛÛŒØ±
class DeveloperInfo:
    NAME = "Ø´Ø§ÛØ¯ Ø§Ø­Ù…Ø¯ Ù…Ø²Ø§Ø±ÛŒ"
    WHATSAPP = "03326179672"
    EMAIL = "shahidahmadmazari@gmail.com"
    COMPANY = "Ù…Ø²Ø§Ø±ÛŒ ÚˆÛŒØ¬ÛŒÙ¹Ù„ Ø³ÙˆÙ„ÙˆØ´Ù†Ø²"
    TAGLINE = "Ù¾ÛŒØ´Û ÙˆØ±Ø§Ù†Û ÙˆÛŒÚˆÛŒÙˆ Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯ Ø§ÙˆØ± ÚˆÛŒØ¬ÛŒÙ¹Ù„ Ù…Ø§Ø±Ú©ÛŒÙ¹Ù†Ú¯"
    WEBSITE = "mazaridigital.com (Ø¬Ù„Ø¯ Ø¢Ø±ÛØ§ ÛÛ’)"
    ADDRESS = "Ù„Ø§ÛÙˆØ±ØŒ Ù¾Ø§Ú©Ø³ØªØ§Ù†"
    
    @staticmethod
    def get_contact_cards():
        return {
            "whatsapp": f"https://wa.me/{DeveloperInfo.WHATSAPP}",
            "email": f"mailto:{DeveloperInfo.EMAIL}",
            "phone": f"tel:{DeveloperInfo.WHATSAPP}",
            "portfolio": "#"
        }

# Ø§ÛŒÙ¾ Ú©ÛŒ Ø¬Ø§Ù…Ø¹ ØªØ±ØªÛŒØ¨Ø§Øª
class AppConfig:
    # ÙˆÛŒØ¨ ÛÚ© ÛŒÙˆØ¢Ø±Ø§ÛŒÙ„ (Ø¢Ù¾ Ø§Ù¾Ù†ÛŒ Ø¶Ø±ÙˆØ±Øª Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚ ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±ÛŒÚº)
    WEBHOOK_URL = "https://hook.us2.make.com/zxh2tmrxbw43d0m7r0noijxu6213mvqo"
    
    # ÙØ§Ø¦Ù„ Ú©ÛŒ Ø­Ø¯ Ø¨Ù†Ø¯ÛŒ
    MAX_FILE_SIZE = 2 * 1024 * 1024 * 1024  # 2GB
    ALLOWED_EXTENSIONS = ["mp4", "mov", "avi", "mkv", "wmv", "flv", "webm", "mpeg", "mpg", "m4v"]
    
    # Ù¾Ø§ÙˆØ± ÙˆØ±ÚˆØ² Ú©ÛŒ Ø¬Ø§Ù…Ø¹ ÙÛØ±Ø³Øª
    POWER_WORDS = [
        "ğŸ”¥ ÙˆØ§Ø¦Ø±Ù„ ÙˆÛŒÚˆÛŒÙˆ", "âš¡ ÙÙˆØ±ÛŒ Ø¯ÛŒÚ©Ú¾ÛŒÚº", "ğŸ¬ Ø³Ù†ÛŒÙ…Ø§Ù¹Ú©", "ğŸ’ Ù¾Ø±ÛŒÙ…ÛŒÙ…", 
        "ğŸš€ Ø§ÛŒÙ¾Ú© Ú©Ø§Ù†Ù¹ÛŒÙ†Ù¹", "ğŸŒŸ Ø­ÛŒØ±Øª Ø§Ù†Ú¯ÛŒØ²", "ğŸ¤¯ Ø¯Ù…Ø§Øº ÛÙ„Ø§ Ø¯ÛŒÙ†Û’ ÙˆØ§Ù„Ø§", 
        "ğŸ’¯ Ø§Ø¹Ù„ÛŒÙ° Ù…Ø¹ÛŒØ§Ø±", "ğŸ‘‘ Ø¨Ø§Ø¯Ø´Ø§Û", "ğŸ“ˆ ØªÛŒØ²ÛŒ Ø³Û’ Ø¨Ú‘Ú¾ Ø±ÛØ§", 
        "ğŸ¯ ÛØ¯Ù Ø­Ø§ØµÙ„", "ğŸ’¥ Ø¯Ú¾Ù…Ø§Ú©Û Ø®ÛŒØ²", "âœ¨ Ø®ØµÙˆØµÛŒ", "ğŸ† ÙØ§ØªØ­", 
        "ğŸ’¼ Ù¾ÛŒØ´Û ÙˆØ±Ø§Ù†Û", "ğŸŒ Ø¹Ø§Ù„Ù…ÛŒ Ù¾ÛÙ†Ú†", "ğŸ“Š ÚˆÛŒÙ¹Ø§ Ø³Û’ Ú†Ù„Ù†Û’ ÙˆØ§Ù„Ø§",
        "ğŸ¤ ØªØ¹Ø§ÙˆÙ†", "ğŸ¨ ØªØ®Ù„ÛŒÙ‚ÛŒ", "ğŸš€ Ù†Ø¦ÛŒ Ù¹ÛŒÚ©Ù†Ø§Ù„ÙˆØ¬ÛŒ", "ğŸ’¡ Ø§Ù†Ù‚Ù„Ø§Ø¨ÛŒ",
        "ğŸ… Ø¨ÛŒØ³Ù¹ Ø³ÛŒÙ„Ø±", "â­ 5 Ø³Ù¹Ø§Ø± Ø±ÛŒÙ¹Úˆ", "ğŸ” Ù¹Ø§Ù¾ Ø±ÛŒÙ†Ú©Ù†Ú¯",
        "ğŸª Ø´Ùˆ Ø§Ø³Ù¹Ø§Ù¾Ø±", "ğŸŒªï¸ Ø·ÙˆÙØ§Ù†", "ğŸ’° Ù‚ÛŒÙ…ØªÛŒ", "ğŸ”® Ù…Ø³ØªÙ‚Ø¨Ù„ Ø¨ÛŒÙ†",
        "ğŸ° Ø´Ø§ÛÚ©Ø§Ø±", "ğŸ­ ÚˆØ±Ø§Ù…Ø§Ø¦ÛŒ", "ğŸŒ… ÛŒØ§Ø¯Ú¯Ø§Ø±", "âš“ Ù‚Ø§Ø¨Ù„ Ø§Ø¹ØªÙ…Ø§Ø¯"
    ]
    
    # Ø±Ù†Ú¯ÙˆÚº Ú©Ø§ Ø§Ø³Ú©ÛŒÙ…
    COLOR_SCHEME = {
        "primary": "#1E3A8A",      # Ù†ÛŒÙ„Ø§
        "secondary": "#059669",    # Ø³Ø¨Ø²
        "accent": "#7C3AED",       # Ø¬Ø§Ù…Ù†ÛŒ
        "warning": "#F59E0B",      # Ø³Ù†ÛØ±ÛŒ
        "danger": "#DC2626",       # Ø³Ø±Ø®
        "dark": "#1F2937",         # Ú¯ÛØ±Ø§
        "light": "#F9FAFB"         # ÛÙ„Ú©Ø§
    }
    
    # Ø§Ù¾ Ù„ÙˆÚˆ Ú©ÛŒ ØªØ±ØªÛŒØ¨Ø§Øª
    UPLOAD_SETTINGS = {
        "auto_watermark": True,
        "watermark_text": "Mazari Digital Solutions",
        "auto_compress": False,
        "add_timestamp": True,
        "generate_thumbnail": False
    }

# ==================== Ø§Ø¹Ø§Ù†Øª Ú©Ù†Ù†Ø¯Û Ø§ÙØ¹Ø§Ù„ ====================
class HelperFunctions:
    @staticmethod
    def load_lottie_url(url: str):
        """Lottie animations Ù„ÙˆÚˆ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†"""
        try:
            r = requests.get(url)
            if r.status_code == 200:
                return r.json()
        except:
            return None
    
    @staticmethod
    def get_file_icon(file_type: str):
        """ÙØ§Ø¦Ù„ Ú©ÛŒ Ù‚Ø³Ù… Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚ Ø¢Ø¦ÛŒÚ©Ù† ÙˆØ§Ù¾Ø³ Ú©Ø±ØªØ§ ÛÛ’"""
        icons = {
            "video": "ğŸ¬",
            "image": "ğŸ–¼ï¸",
            "document": "ğŸ“„",
            "audio": "ğŸµ",
            "archive": "ğŸ“¦"
        }
        return icons.get(file_type, "ğŸ“")
    
    @staticmethod
    def format_file_size(size_bytes):
        """ÙØ§Ø¦Ù„ Ø³Ø§Ø¦Ø² Ú©Ùˆ Ù¾Ú‘Ú¾Ù†Û’ Ú©Û’ Ù‚Ø§Ø¨Ù„ Ø´Ú©Ù„ Ù…ÛŒÚº ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±ØªØ§ ÛÛ’"""
        for unit in ['B', 'KB', 'MB', 'GB', 'TB']:
            if size_bytes < 1024.0:
                return f"{size_bytes:.2f} {unit}"
            size_bytes /= 1024.0
        return f"{size_bytes:.2f} PB"
    
    @staticmethod
    def generate_file_id(file_content):
        """ÙØ§Ø¦Ù„ Ú©Û’ Ù„ÛŒÛ’ Ù…Ù†ÙØ±Ø¯ ID Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        return hashlib.sha256(file_content).hexdigest()[:16]
    
    @staticmethod
    def validate_file(file, max_size):
        """ÙØ§Ø¦Ù„ Ú©ÛŒ Ù…Ú©Ù…Ù„ ØªØµØ¯ÛŒÙ‚ Ú©Ø±ØªØ§ ÛÛ’"""
        errors = []
        
        # Ø³Ø§Ø¦Ø² Ú©ÛŒ ØªØµØ¯ÛŒÙ‚
        if file.size > max_size:
            errors.append(f"âŒ ÙØ§Ø¦Ù„ Ø³Ø§Ø¦Ø² {HelperFunctions.format_file_size(file.size)} ÛÛ’ØŒ Ø¬Ø¨Ú©Û Ø­Ø¯ {HelperFunctions.format_file_size(max_size)} ÛÛ’Û”")
        
        # Ø§ÛŒÚ©Ø³Ù¹ÛŒÙ†Ø´Ù† Ú©ÛŒ ØªØµØ¯ÛŒÙ‚
        extension = Path(file.name).suffix.lower()[1:] if '.' in file.name else ''
        if extension not in AppConfig.ALLOWED_EXTENSIONS:
            errors.append(f"âŒ ØºÛŒØ± Ù…Ø¹Ø§ÙˆÙ† ÙØ§Ø¦Ù„ ÙØ§Ø±Ù…ÛŒÙ¹: .{extension}")
        
        return errors
    
    @staticmethod
    def create_progress_widget():
        """Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø± ÙˆÛŒØ¬Ù¹ Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        progress_bar = st.progress(0)
        status_text = st.empty()
        return progress_bar, status_text
    
    @staticmethod
    def update_progress(progress_bar, status_text, value, message):
        """Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø± Ø§Ù¾ ÚˆÛŒÙ¹ Ú©Ø±ØªØ§ ÛÛ’"""
        progress_bar.progress(value)
        status_text.info(f"ğŸ”„ {message}... {value}%")

# ==================== Ø³ÛŒØ´Ù† Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹ ====================
class SessionManager:
    @staticmethod
    def initialize():
        """Ø³ÛŒØ´Ù† Ø§Ø³Ù¹ÛŒÙ¹ Ø´Ø±ÙˆØ¹ Ú©Ø±ØªØ§ ÛÛ’"""
        if 'uploads' not in st.session_state:
            st.session_state.uploads = []
        
        if 'stats' not in st.session_state:
            st.session_state.stats = {
                'total_uploads': 0,
                'total_size': 0,
                'successful': 0,
                'failed': 0,
                'daily_uploads': {}
            }
        
        if 'settings' not in st.session_state:
            st.session_state.settings = AppConfig.UPLOAD_SETTINGS.copy()
        
        if 'user_quota' not in st.session_state:
            st.session_state.user_quota = {
                'daily_limit': 20,
                'uploads_today': 0,
                'reset_time': datetime.now() + timedelta(days=1)
            }
    
    @staticmethod
    def add_upload_record(file_info):
        """Ø§Ù¾ Ù„ÙˆÚˆ Ø±ÛŒÚ©Ø§Ø±Úˆ Ø´Ø§Ù…Ù„ Ú©Ø±ØªØ§ ÛÛ’"""
        st.session_state.uploads.append(file_info)
        
        # Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø± Ø§Ù¾ ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
        st.session_state.stats['total_uploads'] += 1
        st.session_state.stats['total_size'] += file_info.get('size', 0)
        
        if file_info.get('status') == 'success':
            st.session_state.stats['successful'] += 1
        else:
            st.session_state.stats['failed'] += 1
        
        # Ø±ÙˆØ²Ø§Ù†Û Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø§Ø¤Ù†Ù¹
        today = datetime.now().date()
        if today not in st.session_state.stats['daily_uploads']:
            st.session_state.stats['daily_uploads'][today] = 0
        st.session_state.stats['daily_uploads'][today] += 1
        
        # Ú©ÙˆÙ¹Ø§ Ø§Ù¾ ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
        st.session_state.user_quota['uploads_today'] += 1
    
    @staticmethod
    def check_quota():
        """Ù…ÙˆØ¬ÙˆØ¯Û Ú©ÙˆÙ¹Ø§ Ú†ÛŒÚ© Ú©Ø±ØªØ§ ÛÛ’"""
        # Ø§Ú¯Ø± Ø±ÛŒ Ø³ÛŒÙ¹ Ú©Ø§ ÙˆÙ‚Øª Ú¯Ø²Ø± Ú¯ÛŒØ§ ÛÙˆ
        if datetime.now() > st.session_state.user_quota['reset_time']:
            st.session_state.user_quota['uploads_today'] = 0
            st.session_state.user_quota['reset_time'] = datetime.now() + timedelta(days=1)
        
        remaining = st.session_state.user_quota['daily_limit'] - st.session_state.user_quota['uploads_today']
        return max(0, remaining)

# ==================== ÙˆÛŒÚˆÛŒÙˆ Ù¾Ø±ÙˆØ³ÛŒØ³Ø± ====================
class VideoProcessor:
    def __init__(self):
        self.config = AppConfig()
    
    def process_video(self, file, power_word, custom_name=None):
        """ÙˆÛŒÚˆÛŒÙˆ ÙØ§Ø¦Ù„ Ú©Ùˆ Ù¾Ø±ÙˆØ³ÛŒØ³ Ú©Ø±ØªØ§ ÛÛ’"""
        try:
            # ÙØ§Ø¦Ù„ Ú©Ø§ Ù…ÙˆØ§Ø¯ Ù¾Ú‘Ú¾ÛŒÚº
            file_content = file.getvalue()
            
            # ÙØ§Ø¦Ù†Ù„ ÙØ§Ø¦Ù„ Ù†Ø§Ù… Ø¨Ù†Ø§Ø¦ÛŒÚº
            if custom_name:
                final_name = custom_name
            else:
                original_name = Path(file.name).stem
                extension = Path(file.name).suffix
                final_name = f"{power_word} - {original_name}{extension}"
            
            # Ù…ÛŒÙ¹Ø§ ÚˆÛŒÙ¹Ø§ ØªÛŒØ§Ø± Ú©Ø±ÛŒÚº
            metadata = {
                "filename": final_name,
                "original_name": file.name,
                "size": file.size,
                "file_id": HelperFunctions.generate_file_id(file_content),
                "upload_time": datetime.now().isoformat(),
                "developer": DeveloperInfo.NAME,
                "contact_whatsapp": DeveloperInfo.WHATSAPP,
                "contact_email": DeveloperInfo.EMAIL,
                "power_word": power_word,
                "watermark": st.session_state.settings.get('watermark_text', ''),
                "app_version": "3.0.0",
                "upload_source": "Mazari YouTube Uploader Pro"
            }
            
            return final_name, file_content, metadata
            
        except Exception as e:
            logger.error(f"Video processing error: {e}")
            raise

# ==================== ÙˆÛŒØ¨ ÛÚ© Ù…ÛŒÙ†ÛŒØ¬Ø± ====================
class WebhookManager:
    def __init__(self, webhook_url):
        self.webhook_url = webhook_url
        self.timeout = 300  # 5 Ù…Ù†Ù¹
    
    def send_file(self, filename, file_content, metadata):
        """ÙØ§Ø¦Ù„ Ú©Ùˆ ÙˆÛŒØ¨ ÛÚ© Ù¾Ø± Ø¨Ú¾ÛŒØ¬ØªØ§ ÛÛ’"""
        try:
            # ÙØ§Ø¦Ù„ ØªÛŒØ§Ø± Ú©Ø±ÛŒÚº
            files = {
                'file': (filename, file_content, 'video/mp4')
            }
            
            # ÚˆÛŒÙ¹Ø§ ØªÛŒØ§Ø± Ú©Ø±ÛŒÚº
            data = {
                'metadata': json.dumps(metadata, ensure_ascii=False)
            }
            
            # POST request Ø¨Ú¾ÛŒØ¬ÛŒÚº
            response = requests.post(
                self.webhook_url,
                files=files,
                data=data,
                timeout=self.timeout
            )
            
            # Ø±Ø³Ù¾Ø§Ù†Ø³ Ù„ÙˆÚ¯ Ú©Ø±ÛŒÚº
            logger.info(f"Webhook response: {response.status_code}")
            
            return {
                'success': response.status_code == 200,
                'status_code': response.status_code,
                'message': response.text,
                'metadata': metadata
            }
            
        except requests.exceptions.Timeout:
            logger.error("Webhook request timeout")
            return {
                'success': False,
                'error': 'timeout',
                'message': 'Ø³Ø±ÙˆØ± Ú©Ø§ Ø¬ÙˆØ§Ø¨ Ù…ÙˆØµÙˆÙ„ Ù†ÛÛŒÚº ÛÙˆØ§Û”'
            }
        except Exception as e:
            logger.error(f"Webhook error: {e}")
            return {
                'success': False,
                'error': str(e),
                'message': 'Ù†Ø§ Ù…Ø¹Ù„ÙˆÙ… Ø®Ø±Ø§Ø¨ÛŒ'
            }

# ==================== ÚˆÛŒØ´ Ø¨ÙˆØ±Úˆ Ú©Ù…Ù¾ÙˆÙ†Ù†Ù¹Ø³ ====================
class DashboardComponents:
    @staticmethod
    def create_header():
        """Ù…Ø±Ú©Ø²ÛŒ ÛÛŒÚˆØ± Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        col1, col2, col3 = st.columns([1, 2, 1])
        
        with col2:
            st.markdown(f"""
            <div style="text-align: center; padding: 2rem; background: linear-gradient(135deg, {AppConfig.COLOR_SCHEME['primary']}, {AppConfig.COLOR_SCHEME['accent']}); 
                     border-radius: 20px; color: white; margin-bottom: 2rem;">
                <h1 style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ¬ Ù…Ø²Ø§Ø±ÛŒ YouTube Ø§Ù¾ Ù„ÙˆÚˆØ±</h1>
                <h3 style="font-weight: 300; margin-bottom: 1rem;">Ù¾ÛŒØ´Û ÙˆØ±Ø§Ù†Û ÙˆÛŒÚˆÛŒÙˆ Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯ Ù¾Ù„ÛŒÙ¹ ÙØ§Ø±Ù…</h3>
                <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 10px; display: inline-block;">
                    <p style="margin: 0; font-size: 1.1rem;">
                        <strong>ğŸ‘¨â€ğŸ’¼ ÚˆÙˆÛŒÙ„Ù¾Ø±:</strong> {DeveloperInfo.NAME}<br>
                        <strong>ğŸ“± Ø±Ø§Ø¨Ø·Û:</strong> {DeveloperInfo.WHATSAPP}<br>
                        <strong>âœ‰ï¸ Ø§ÛŒ Ù…ÛŒÙ„:</strong> {DeveloperInfo.EMAIL}
                    </p>
                </div>
            </div>
            """, unsafe_allow_html=True)
    
    @staticmethod
    def create_stats_cards():
        """Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø± Ú©Û’ Ú©Ø§Ø±ÚˆØ² Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        cols = st.columns(4)
        
        with cols[0]:
            st.metric(
                "ğŸ“Š Ú©Ù„ Ø§Ù¾ Ù„ÙˆÚˆØ²",
                st.session_state.stats['total_uploads'],
                help="Ø§Ø¨ ØªÚ© Ú©ÛŒ Ú©Ù„ Ø§Ù¾ Ù„ÙˆÚˆ Ø´Ø¯Û ÙØ§Ø¦Ù„Ø²"
            )
        
        with cols[1]:
            st.metric(
                "ğŸ’¾ Ú©Ù„ ÚˆÛŒÙ¹Ø§",
                HelperFunctions.format_file_size(st.session_state.stats['total_size']),
                help="Ú©Ù„ Ø§Ù¾ Ù„ÙˆÚˆ Ø´Ø¯Û ÚˆÛŒÙ¹Ø§ Ú©Ø§ Ø³Ø§Ø¦Ø²"
            )
        
        with cols[2]:
            success_rate = 0
            if st.session_state.stats['total_uploads'] > 0:
                success_rate = (st.session_state.stats['successful'] / st.session_state.stats['total_uploads']) * 100
            st.metric(
                "âœ… Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ú©ÛŒ Ø´Ø±Ø­",
                f"{success_rate:.1f}%",
                help="Ú©Ø§Ù…ÛŒØ§Ø¨ Ø§Ù¾ Ù„ÙˆÚˆØ² Ú©Ø§ ÙÛŒØµØ¯"
            )
        
        with cols[3]:
            remaining = SessionManager.check_quota()
            st.metric(
                "ğŸ¯ Ø¨Ø§Ù‚ÛŒ Ú©ÙˆÙ¹Ø§",
                f"{remaining}/{st.session_state.user_quota['daily_limit']}",
                help="Ø¢Ø¬ Ú©Û’ Ù„ÛŒÛ’ Ø¨Ø§Ù‚ÛŒ Ø§Ù¾ Ù„ÙˆÚˆØ²"
            )
    
    @staticmethod
    def create_contact_section():
        """Ø±Ø§Ø¨Ø·Û’ Ú©Ø§ Ø³ÛŒÚ©Ø´Ù† Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        st.markdown("---")
        st.markdown("### ğŸ“ ÙÙˆØ±ÛŒ Ø±Ø§Ø¨Ø·Û")
        
        contacts = DeveloperInfo.get_contact_cards()
        
        col1, col2, col3, col4 = st.columns(4)
        
        with col1:
            st.markdown(f"""
            <a href="{contacts['whatsapp']}" target="_blank" style="text-decoration: none;">
                <div style="background: #25D366; color: white; padding: 1rem; border-radius: 10px; text-align: center; cursor: pointer; transition: transform 0.3s;">
                    <div style="font-size: 2rem;">ğŸ“±</div>
                    <strong>ÙˆÙ¹Ø³ Ø§ÛŒÙ¾</strong>
                    <p style="font-size: 0.8rem; margin: 0;">{DeveloperInfo.WHATSAPP}</p>
                </div>
            </a>
            """, unsafe_allow_html=True)
        
        with col2:
            st.markdown(f"""
            <a href="{contacts['email']}" style="text-decoration: none;">
                <div style="background: #EA4335; color: white; padding: 1rem; border-radius: 10px; text-align: center; cursor: pointer; transition: transform 0.3s;">
                    <div style="font-size: 2rem;">âœ‰ï¸</div>
                    <strong>Ø§ÛŒ Ù…ÛŒÙ„</strong>
                    <p style="font-size: 0.8rem; margin: 0;">{DeveloperInfo.EMAIL}</p>
                </div>
            </a>
            """, unsafe_allow_html=True)
        
        with col3:
            st.markdown(f"""
            <a href="{contacts['phone']}" style="text-decoration: none;">
                <div style="background: #4285F4; color: white; padding: 1rem; border-radius: 10px; text-align: center; cursor: pointer; transition: transform 0.3s;">
                    <div style="font-size: 2rem;">ğŸ“</div>
                    <strong>ÙÙˆÙ† Ú©Ø§Ù„</strong>
                    <p style="font-size: 0.8rem; margin: 0;">{DeveloperInfo.WHATSAPP}</p>
                </div>
            </a>
            """, unsafe_allow_html=True)
        
        with col4:
            st.markdown(f"""
            <a href="#portfolio" style="text-decoration: none;">
                <div style="background: {AppConfig.COLOR_SCHEME['accent']}; color: white; padding: 1rem; border-radius: 10px; text-align: center; cursor: pointer; transition: transform 0.3s;">
                    <div style="font-size: 2rem;">ğŸ“</div>
                    <strong>Ù¾ÙˆØ±Ù¹ ÙÙˆÙ„ÛŒÙˆ</strong>
                    <p style="font-size: 0.8rem; margin: 0;">{DeveloperInfo.COMPANY}</p>
                </div>
            </a>
            """, unsafe_allow_html=True)
    
    @staticmethod
    def create_analytics_charts():
        """ØªØ¬Ø²ÛŒØ§ØªÛŒ Ú†Ø§Ø±Ù¹Ø³ Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        if st.session_state.stats['total_uploads'] == 0:
            st.info("ğŸ“ˆ Ø§Ø¨Ú¾ÛŒ ØªÚ© Ú©Ø§ÙÛŒ ÚˆÛŒÙ¹Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº ÛÛ’Û” Ù¾ÛÙ„ÛŒ ÙˆÛŒÚˆÛŒÙˆ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº!")
            return
        
        # Ø±ÙˆØ²Ø§Ù†Û Ø§Ù¾ Ù„ÙˆÚˆØ² Ú©Ø§ Ú†Ø§Ø±Ù¹
        daily_data = st.session_state.stats['daily_uploads']
        if daily_data:
            df_daily = pd.DataFrame(list(daily_data.items()), columns=['ØªØ§Ø±ÛŒØ®', 'ØªØ¹Ø¯Ø§Ø¯'])
            fig = px.line(df_daily, x='ØªØ§Ø±ÛŒØ®', y='ØªØ¹Ø¯Ø§Ø¯', 
                         title='ğŸ“… Ø±ÙˆØ²Ø§Ù†Û Ø§Ù¾ Ù„ÙˆÚˆØ² Ú©Ø§ Ú¯Ø±Ø§Ù',
                         line_shape='spline')
            st.plotly_chart(fig, use_container_width=True)
        
        # Ù¾Ø§ÙˆØ± ÙˆØ±ÚˆØ² Ú©Ø§ ØªØ¬Ø²ÛŒÛ
        if st.session_state.uploads:
            power_words_used = [upload.get('power_word', 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…') 
                              for upload in st.session_state.uploads 
                              if upload.get('power_word')]
            
            if power_words_used:
                from collections import Counter
                word_counts = Counter(power_words_used)
                top_words = dict(word_counts.most_common(10))
                
                fig2 = px.bar(x=list(top_words.keys()), y=list(top_words.values()),
                             title='ğŸ¯ Ø³Ø¨ Ø³Û’ Ø²ÛŒØ§Ø¯Û Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆÙ†Û’ ÙˆØ§Ù„Û’ Ù¾Ø§ÙˆØ± ÙˆØ±ÚˆØ²',
                             labels={'x': 'Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ', 'y': 'ØªØ¹Ø¯Ø§Ø¯'})
                st.plotly_chart(fig2, use_container_width=True)

# ==================== Ù…Ø±Ú©Ø²ÛŒ Ø§ÛŒÙ¾Ù„ÛŒÚ©ÛŒØ´Ù† ====================
class MazariYouTubeUploader:
    def __init__(self):
        self.setup_page_config()
        SessionManager.initialize()
        self.processor = VideoProcessor()
        self.webhook_manager = WebhookManager(AppConfig.WEBHOOK_URL)
        
    def setup_page_config(self):
        """ØµÙØ­Û Ú©ÛŒ ØªØ±ØªÛŒØ¨Ø§Øª Ø·Û’ Ú©Ø±ØªØ§ ÛÛ’"""
        st.set_page_config(
            page_title=f"{DeveloperInfo.COMPANY} | {DeveloperInfo.NAME}",
            page_icon="ğŸš€",
            layout="wide",
            initial_sidebar_state="expanded",
            menu_items={
                'Get Help': f'https://wa.me/{DeveloperInfo.WHATSAPP}',
                'Report a bug': f'mailto:{DeveloperInfo.EMAIL}',
                'About': f'''
                ## {DeveloperInfo.COMPANY}
                
                **ÚˆÙˆÛŒÙ„Ù¾Ø±:** {DeveloperInfo.NAME}
                **Ø±Ø§Ø¨Ø·Û:** {DeveloperInfo.WHATSAPP}
                **Ø§ÛŒ Ù…ÛŒÙ„:** {DeveloperInfo.EMAIL}
                **Ú©Ù…Ù¾Ù†ÛŒ:** {DeveloperInfo.COMPANY}
                **ÙˆØ±Ú˜Ù†:** 3.0.0
                
                ÛŒÛ Ø§ÛŒÙ¾ Ù¾ÛŒØ´Û ÙˆØ±Ø§Ù†Û ÙˆÛŒÚˆÛŒÙˆ Ø§Ù¾ Ù„ÙˆÚˆÙ†Ú¯ Ø§ÙˆØ± 
                Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯ Ú©Û’ Ù„ÛŒÛ’ Ø¨Ù†Ø§Ø¦ÛŒ Ú¯Ø¦ÛŒ ÛÛ’Û”
                '''
            }
        )
        
        # Ú©Ø³Ù¹Ù… CSS Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº
        self.inject_custom_css()
    
    def inject_custom_css(self):
        """Ø§Ù¾Ù†ÛŒ Ù…Ø±Ø¶ÛŒ Ú©Ø§ CSS Ø´Ø§Ù…Ù„ Ú©Ø±ØªØ§ ÛÛ’"""
        st.markdown(f"""
        <style>
            /* Ø¨Ù†ÛŒØ§Ø¯ÛŒ ØªØ±ØªÛŒØ¨Ø§Øª */
            .stApp {{
                background: linear-gradient(135deg, {AppConfig.COLOR_SCHEME['light']} 0%, #ffffff 100%);
            }}
            
            /* ÛÛŒÚˆÙ†Ú¯Ø² */
            h1, h2, h3, h4, h5, h6 {{
                font-family: 'Noto Sans Arabic', 'Segoe UI', sans-serif;
                color: {AppConfig.COLOR_SCHEME['primary']};
            }}
            
            /* Ú©Ø§Ø±ÚˆØ² */
            .custom-card {{
                background: white;
                padding: 1.5rem;
                border-radius: 15px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                border-left: 5px solid {AppConfig.COLOR_SCHEME['secondary']};
                margin-bottom: 1rem;
                transition: transform 0.3s, box-shadow 0.3s;
            }}
            
            .custom-card:hover {{
                transform: translateY(-5px);
                box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            }}
            
            /* Ø¨Ù¹Ù†Ø² */
            .stButton > button {{
                background: linear-gradient(135deg, {AppConfig.COLOR_SCHEME['primary']} 0%, {AppConfig.COLOR_SCHEME['accent']} 100%);
                color: white;
                border: none;
                border-radius: 10px;
                padding: 12px 24px;
                font-weight: bold;
                transition: all 0.3s;
            }}
            
            .stButton > button:hover {{
                transform: scale(1.02);
                box-shadow: 0 5px 15px rgba({int(AppConfig.COLOR_SCHEME['primary'][1:3], 16)}, 
                                           {int(AppConfig.COLOR_SCHEME['primary'][3:5], 16)}, 
                                           {int(AppConfig.COLOR_SCHEME['primary'][5:7], 16)}, 0.3);
            }}
            
            /* Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø± */
            .stProgress > div > div > div {{
                background: linear-gradient(90deg, {AppConfig.COLOR_SCHEME['secondary']}, {AppConfig.COLOR_SCHEME['accent']});
            }}
            
            /* Ù¹ÛŒØ¨Ø² */
            .stTabs [data-baseweb="tab-list"] {{
                gap: 2px;
            }}
            
            .stTabs [data-baseweb="tab"] {{
                border-radius: 10px 10px 0 0;
                padding: 10px 20px;
            }}
            
            /* ÙÙ¹Ø± */
            .footer {{
                background: {AppConfig.COLOR_SCHEME['dark']};
                color: white;
                padding: 2rem;
                border-radius: 15px;
                margin-top: 3rem;
                text-align: center;
            }}
        </style>
        """, unsafe_allow_html=True)
    
    def create_sidebar(self):
        """Ø³Ø§Ø¦ÛŒÚˆØ¨Ø§Ø± Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        with st.sidebar:
            # ÚˆÙˆÛŒÙ„Ù¾Ø± Ù¾Ø±ÙˆÙØ§Ø¦Ù„
            st.markdown(f"""
            <div class="custom-card">
                <div style="text-align: center;">
                    <div style="font-size: 3rem; color: {AppConfig.COLOR_SCHEME['primary']};">ğŸ‘¨â€ğŸ’¼</div>
                    <h3 style="margin: 0.5rem 0;">{DeveloperInfo.NAME}</h3>
                    <p style="color: {AppConfig.COLOR_SCHEME['secondary']}; font-weight: bold;">{DeveloperInfo.COMPANY}</p>
                    <p style="font-size: 0.9rem;">{DeveloperInfo.TAGLINE}</p>
                </div>
                <hr>
                <div>
                    <p><strong>ğŸ“±:</strong> {DeveloperInfo.WHATSAPP}</p>
                    <p><strong>âœ‰ï¸:</strong> {DeveloperInfo.EMAIL}</p>
                    <p><strong>ğŸ¢:</strong> {DeveloperInfo.ADDRESS}</p>
                </div>
            </div>
            """, unsafe_allow_html=True)
            
            # Ú©ÙˆÙ¹Ø§ Ø§Ù†ÙÙˆØ±Ù…ÛŒØ´Ù†
            remaining = SessionManager.check_quota()
            st.markdown(f"""
            <div class="custom-card">
                <h4>ğŸ¯ Ø±ÙˆØ²Ø§Ù†Û Ú©ÙˆÙ¹Ø§</h4>
                <div style="background: {AppConfig.COLOR_SCHEME['light']}; padding: 1rem; border-radius: 10px; text-align: center;">
                    <h1 style="margin: 0; color: {AppConfig.COLOR_SCHEME['primary']};">{remaining}</h1>
                    <p style="margin: 0;">/ {st.session_state.user_quota['daily_limit']} Ø§Ù¾ Ù„ÙˆÚˆØ² Ø¨Ø§Ù‚ÛŒ</p>
                </div>
                <div style="margin-top: 1rem; height: 10px; background: #e5e7eb; border-radius: 5px;">
                    <div style="height: 100%; width: {min(100, (st.session_state.user_quota['uploads_today']/st.session_state.user_quota['daily_limit'])*100)}%; 
                         background: {AppConfig.COLOR_SCHEME['secondary']}; border-radius: 5px;"></div>
                </div>
            </div>
            """, unsafe_allow_html=True)
            
            # ØªØ±ØªÛŒØ¨Ø§Øª
            st.markdown("### âš™ï¸ ØªØ±ØªÛŒØ¨Ø§Øª")
            
            with st.expander("ğŸ¯ Ù¾Ø§ÙˆØ± ÙˆØ±ÚˆØ²", expanded=True):
                custom_words = st.text_area(
                    "Ø§Ù¾Ù†Û’ Ù¾Ø§ÙˆØ± ÙˆØ±ÚˆØ² (ÛØ± Ù„Ø§Ø¦Ù† Ù¾Ø± Ø§ÛŒÚ©)",
                    value="\n".join(AppConfig.POWER_WORDS),
                    height=150
                )
                if st.button("ğŸ’¾ Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº", use_container_width=True):
                    AppConfig.POWER_WORDS = [w.strip() for w in custom_words.split('\n') if w.strip()]
                    st.success("âœ… Ù¾Ø§ÙˆØ± ÙˆØ±ÚˆØ² Ù…Ø­ÙÙˆØ¸ ÛÙˆ Ú¯Ø¦Û’!")
            
            with st.expander("ğŸ”§ Ø§Ù¾ Ù„ÙˆÚˆ ØªØ±ØªÛŒØ¨Ø§Øª"):
                st.session_state.settings['auto_watermark'] = st.checkbox(
                    "Ø®ÙˆØ¯Ú©Ø§Ø± ÙˆØ§Ù¹Ø± Ù…Ø§Ø±Ú©",
                    value=st.session_state.settings['auto_watermark']
                )
                
                if st.session_state.settings['auto_watermark']:
                    st.session_state.settings['watermark_text'] = st.text_input(
                        "ÙˆØ§Ù¹Ø± Ù…Ø§Ø±Ú© Ù¹ÛŒÚ©Ø³Ù¹",
                        value=st.session_state.settings.get('watermark_text', '')
                    )
                
                st.session_state.settings['add_timestamp'] = st.checkbox(
                    "Ù¹Ø§Ø¦Ù… Ø§Ø³Ù¹ÛŒÙ…Ù¾ Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº",
                    value=st.session_state.settings['add_timestamp']
                )
            
            # ÙØ§Ø¦Ù„ Ø³Ø§Ø¦Ø² Ú©ÛŒ Ø­Ø¯
            max_size_mb = st.slider(
                "ğŸ“ Ø²ÛŒØ§Ø¯Û Ø³Û’ Ø²ÛŒØ§Ø¯Û ÙØ§Ø¦Ù„ Ø³Ø§Ø¦Ø² (MB)",
                min_value=50,
                max_value=4096,
                value=2048,
                step=50
            )
            AppConfig.MAX_FILE_SIZE = max_size_mb * 1024 * 1024
            
            # ØªØ§Ø±ÛŒØ® ØµØ§Ù Ú©Ø±ÛŒÚº
            st.markdown("---")
            if st.button("ğŸ—‘ï¸ ØªØ§Ø±ÛŒØ® ØµØ§Ù Ú©Ø±ÛŒÚº", use_container_width=True):
                st.session_state.uploads = []
                st.session_state.stats = {
                    'total_uploads': 0,
                    'total_size': 0,
                    'successful': 0,
                    'failed': 0,
                    'daily_uploads': {}
                }
                st.success("âœ… ØªØ§Ø±ÛŒØ® ØµØ§Ù ÛÙˆ Ú¯Ø¦ÛŒ!")
                st.rerun()
    
    def upload_tab(self):
        """Ø§Ù¾ Ù„ÙˆÚˆ Ù¹ÛŒØ¨ Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        st.markdown("### ğŸ“¤ ÙˆÛŒÚˆÛŒÙˆ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº")
        
        # ÙØ§Ø¦Ù„ Ø§Ù¾ Ù„ÙˆÚˆØ±
        uploaded_file = st.file_uploader(
            "ÙˆÛŒÚˆÛŒÙˆ ÙØ§Ø¦Ù„ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº",
            type=AppConfig.ALLOWED_EXTENSIONS,
            help=f"Ø­Ø¯Ø§Ú©Ø«Ø± Ø³Ø§Ø¦Ø²: {HelperFunctions.format_file_size(AppConfig.MAX_FILE_SIZE)}"
        )
        
        if uploaded_file:
            # ÙØ§Ø¦Ù„ Ú©ÛŒ ØªØµØ¯ÛŒÙ‚
            errors = HelperFunctions.validate_file(uploaded_file, AppConfig.MAX_FILE_SIZE)
            
            if errors:
                for error in errors:
                    st.error(error)
                return
            
            # ÙØ§Ø¦Ù„ Ú©ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¯Ú©Ú¾Ø§Ø¦ÛŒÚº
            col1, col2 = st.columns([2, 1])
            
            with col1:
                st.markdown("#### ğŸ¬ ÙˆÛŒÚˆÛŒÙˆ Ù¾Ø±ÛŒÙˆÛŒÙˆ")
                st.video(uploaded_file)
                
                # ØªÙØµÛŒÙ„ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
                with st.expander("ğŸ“‹ ÙØ§Ø¦Ù„ Ú©ÛŒ ØªÙØµÛŒÙ„Ø§Øª", expanded=True):
                    info_col1, info_col2 = st.columns(2)
                    
                    with info_col1:
                        st.info(f"**Ù†Ø§Ù…:** {uploaded_file.name}")
                        st.info(f"**Ø³Ø§Ø¦Ø²:** {HelperFunctions.format_file_size(uploaded_file.size)}")
                        st.info(f"**Ù‚Ø³Ù…:** {uploaded_file.type if hasattr(uploaded_file, 'type') else 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…'}")
                    
                    with info_col2:
                        file_id = HelperFunctions.generate_file_id(uploaded_file.getvalue())
                        st.info(f"**ÙØ§Ø¦Ù„ ID:** `{file_id}`")
                        st.success("âœ… ÙØ§Ø¦Ù„ ØªØµØ¯ÛŒÙ‚ Ø´Ø¯Û")
                        
                        # Ú©ÙˆÙ¹Ø§ Ú†ÛŒÚ©
                        remaining = SessionManager.check_quota()
                        if remaining == 0:
                            st.error("âŒ Ø¢Ø¬ Ú©Ø§ Ú©ÙˆÙ¹Ø§ Ø®ØªÙ… ÛÙˆ Ú¯ÛŒØ§ ÛÛ’!")
                        else:
                            st.success(f"âœ… {remaining} Ø§Ù¾ Ù„ÙˆÚˆØ² Ø¨Ø§Ù‚ÛŒ ÛÛŒÚº")
            
            with col2:
                # Ø§Ù¾ Ù„ÙˆÚˆ Ø¢Ù¾Ø´Ù†Ø²
                st.markdown("#### âš¡ Ø§Ù¾ Ù„ÙˆÚˆ Ø¢Ù¾Ø´Ù†Ø²")
                
                # Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº
                power_word_option = st.radio(
                    "Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ Ú©Ø§ Ø§Ù†ØªØ®Ø§Ø¨",
                    ["ğŸ² Ø±ÛŒÙ†ÚˆÙ… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº", "ğŸ“ ÙÛØ±Ø³Øª Ø³Û’ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº"],
                    horizontal=True
                )
                
                if power_word_option == "ğŸ² Ø±ÛŒÙ†ÚˆÙ… Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº":
                    selected_word = random.choice(AppConfig.POWER_WORDS)
                    st.info(f"**Ù…Ù†ØªØ®Ø¨ Ø´Ø¯Û:**\n\n### {selected_word}")
                else:
                    selected_word = st.selectbox(
                        "Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº",
                        AppConfig.POWER_WORDS
                    )
                
                # ÙØ§Ø¦Ù„ Ù†Ø§Ù… Ú©Ø³Ù¹Ù…Ø§Ø¦Ø²ÛŒØ´Ù†
                st.markdown("---")
                st.markdown("#### ğŸ“ ÙØ§Ø¦Ù„ Ù†Ø§Ù…")
                
                default_name = f"{selected_word} - {uploaded_file.name}"
                custom_name = st.text_input(
                    "Ù†ÛŒØ§ ÙØ§Ø¦Ù„ Ù†Ø§Ù…",
                    value=default_name
                )
                
                # Ø§Ù¾ Ù„ÙˆÚˆ Ø¨Ù¹Ù†
                remaining = SessionManager.check_quota()
                upload_disabled = remaining == 0
                
                upload_button = st.button(
                    f"ğŸš€ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº ({HelperFunctions.format_file_size(uploaded_file.size)})",
                    type="primary",
                    disabled=upload_disabled,
                    use_container_width=True
                )
                
                if upload_disabled:
                    st.warning("âš ï¸ Ø¢Ø¬ Ú©Ø§ Ú©ÙˆÙ¹Ø§ Ø®ØªÙ… ÛÙˆ Ú¯ÛŒØ§ ÛÛ’! Ú©Ù„ Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚºÛ”")
            
            # Ø§Ù¾ Ù„ÙˆÚˆ Ù¾Ø±ÙˆØ³ÛŒØ³
            if upload_button:
                self.process_upload(uploaded_file, selected_word, custom_name)
    
    def process_upload(self, file, power_word, custom_name):
        """Ø§Ù¾ Ù„ÙˆÚˆ Ù¾Ø±ÙˆØ³ÛŒØ³ ÛÛŒÙ†ÚˆÙ„ Ú©Ø±ØªØ§ ÛÛ’"""
        try:
            # Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø± Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº
            progress_bar, status_text = HelperFunctions.create_progress_widget()
            
            # Ù…Ø±Ø­Ù„Û 1: ÙØ§Ø¦Ù„ Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯
            HelperFunctions.update_progress(progress_bar, status_text, 20, "ÙØ§Ø¦Ù„ Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯")
            final_name, file_content, metadata = self.processor.process_video(
                file, power_word, custom_name
            )
            
            # Ù…Ø±Ø­Ù„Û 2: ÙˆÛŒØ¨ ÛÚ© Ù¾Ø± Ø¨Ú¾ÛŒØ¬Ù†Ø§
            HelperFunctions.update_progress(progress_bar, status_text, 60, "Ø³Ø±ÙˆØ± Ù¾Ø± Ø¨Ú¾ÛŒØ¬ Ø±ÛØ§ ÛÙˆÚº")
            result = self.webhook_manager.send_file(final_name, file_content, metadata)
            
            # Ù…Ø±Ø­Ù„Û 3: Ù†ØªÛŒØ¬Û Ù¾Ø±ÙˆØ³ÛŒØ³ Ú©Ø±ÛŒÚº
            HelperFunctions.update_progress(progress_bar, status_text, 90, "Ù†ØªÛŒØ¬Û Ù¾Ø±ÙˆØ³ÛŒØ³ Ú©Ø± Ø±ÛØ§ ÛÙˆÚº")
            
            # Ù…Ø±Ø­Ù„Û 4: ØªÚ©Ù…ÛŒÙ„
            HelperFunctions.update_progress(progress_bar, status_text, 100, "ØªÚ©Ù…ÛŒÙ„")
            time.sleep(0.5)
            
            # Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø± ÛÙ¹Ø§Ø¦ÛŒÚº
            progress_bar.empty()
            status_text.empty()
            
            # Ù†ØªÛŒØ¬Û Ø¯Ú©Ú¾Ø§Ø¦ÛŒÚº
            if result.get('success'):
                self.show_success_result(file, final_name, metadata, result)
            else:
                self.show_error_result(result)
                
        except Exception as e:
            st.error(f"âŒ Ø§Ù¾ Ù„ÙˆÚˆ Ù†Ø§Ú©Ø§Ù…: {str(e)}")
            logger.error(f"Upload failed: {e}")
    
    def show_success_result(self, file, final_name, metadata, result):
        """Ú©Ø§Ù…ÛŒØ§Ø¨ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø§ Ù†ØªÛŒØ¬Û Ø¯Ú©Ú¾Ø§ØªØ§ ÛÛ’"""
        st.balloons()
        
        # Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ú©Ø§ Ú©Ø§Ø±Úˆ
        st.markdown(f"""
        <div class="custom-card" style="border-left: 5px solid {AppConfig.COLOR_SCHEME['secondary']};">
            <div style="text-align: center;">
                <div style="font-size: 4rem; color: {AppConfig.COLOR_SCHEME['secondary']};">âœ…</div>
                <h2 style="color: {AppConfig.COLOR_SCHEME['secondary']};">Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ! ÙˆÛŒÚˆÛŒÙˆ Ø§Ù¾ Ù„ÙˆÚˆ ÛÙˆ Ú¯Ø¦ÛŒ</h2>
            </div>
            <hr>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div><strong>ÙØ§Ø¦Ù„ Ù†Ø§Ù…:</strong></div><div>{final_name}</div>
                <div><strong>Ø³Ø§Ø¦Ø²:</strong></div><div>{HelperFunctions.format_file_size(file.size)}</div>
                <div><strong>Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ:</strong></div><div>{metadata.get('power_word')}</div>
                <div><strong>ÙˆÙ‚Øª:</strong></div><div>{datetime.now().strftime('%H:%M:%S')}</div>
                <div><strong>ÙˆØ§Ù¹Ø± Ù…Ø§Ø±Ú©:</strong></div><div>{metadata.get('watermark', 'Ù†ÛÛŒÚº')}</div>
                <div><strong>Ø§Ù¾ Ù„ÙˆÚˆ Ø§Ø²:</strong></div><div>{DeveloperInfo.NAME}</div>
            </div>
        </div>
        """, unsafe_allow_html=True)
        
        # Ø³ÛŒØ´Ù† Ø§Ø³Ù¹ÛŒÙ¹ Ø§Ù¾ ÚˆÛŒÙ¹ Ú©Ø±ÛŒÚº
        upload_record = {
            'filename': final_name,
            'original_name': file.name,
            'size': file.size,
            'power_word': metadata.get('power_word'),
            'timestamp': datetime.now().isoformat(),
            'status': 'success',
            'watermark': metadata.get('watermark', ''),
            'developer': DeveloperInfo.NAME
        }
        SessionManager.add_upload_record(upload_record)
        
        # ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ø¨Ù¹Ù†
        st.download_button(
            label="ğŸ“¥ ÙØ§Ø¦Ù„ ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº",
            data=file.getvalue(),
            file_name=final_name,
            mime=file.type if hasattr(file, 'type') else 'video/mp4',
            use_container_width=True
        )
    
    def show_error_result(self, result):
        """Ù†Ø§Ú©Ø§Ù… Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø§ Ù†ØªÛŒØ¬Û Ø¯Ú©Ú¾Ø§ØªØ§ ÛÛ’"""
        st.markdown(f"""
        <div class="custom-card" style="border-left: 5px solid {AppConfig.COLOR_SCHEME['danger']};">
            <div style="text-align: center;">
                <div style="font-size: 4rem; color: {AppConfig.COLOR_SCHEME['danger']};">âŒ</div>
                <h2 style="color: {AppConfig.COLOR_SCHEME['danger']};">Ø§Ù¾ Ù„ÙˆÚˆ Ù†Ø§Ú©Ø§Ù…</h2>
            </div>
            <hr>
            <div style="text-align: center;">
                <p><strong>Ø®Ø±Ø§Ø¨ÛŒ Ú©ÛŒ Ù‚Ø³Ù…:</strong> {result.get('error', 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…')}</p>
                <p><strong>Ù¾ÛŒØºØ§Ù…:</strong> {result.get('message', 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…')}</p>
                <p><strong>Ø­Ù„:</strong> Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚº ÛŒØ§ {DeveloperInfo.WHATSAPP} Ù¾Ø± Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚºÛ”</p>
            </div>
        </div>
        """, unsafe_allow_html=True)
        
        # Ù†Ø§Ú©Ø§Ù… Ø±ÛŒÚ©Ø§Ø±Úˆ Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº
        upload_record = {
            'filename': 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…',
            'timestamp': datetime.now().isoformat(),
            'status': 'failed',
            'error': result.get('error', 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…')
        }
        SessionManager.add_upload_record(upload_record)
    
    def history_tab(self):
        """ØªØ§Ø±ÛŒØ® Ù¹ÛŒØ¨ Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        st.markdown("### ğŸ“œ Ø§Ù¾ Ù„ÙˆÚˆ ØªØ§Ø±ÛŒØ®")
        
        if not st.session_state.uploads:
            st.info("ğŸ“ Ø§Ø¨Ú¾ÛŒ ØªÚ© Ú©ÙˆØ¦ÛŒ ÙØ§Ø¦Ù„ Ø§Ù¾ Ù„ÙˆÚˆ Ù†ÛÛŒÚº Ú©ÛŒ Ú¯Ø¦ÛŒÛ”")
            return
        
        # ÙÙ„Ù¹Ø±Ø²
        col1, col2, col3 = st.columns(3)
        with col1:
            filter_status = st.selectbox("Ø³Ù¹ÛŒÙ¹Ø³", ["Ø³Ø¨", "Ú©Ø§Ù…ÛŒØ§Ø¨", "Ù†Ø§Ú©Ø§Ù…"])
        with col2:
            filter_date = st.date_input("ØªØ§Ø±ÛŒØ® Ø³Û’")
        with col3:
            filter_power_word = st.selectbox("Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ", ["Ø³Ø¨"] + list(set([u.get('power_word', '') for u in st.session_state.uploads if u.get('power_word')])))
        
        # ÙÙ„Ù¹Ø±Úˆ ÚˆÛŒÙ¹Ø§
        filtered_uploads = st.session_state.uploads.copy()
        
        if filter_status != "Ø³Ø¨":
            filtered_uploads = [u for u in filtered_uploads if u.get('status') == ('success' if filter_status == 'Ú©Ø§Ù…ÛŒØ§Ø¨' else 'failed')]
        
        if filter_power_word != "Ø³Ø¨":
            filtered_uploads = [u for u in filtered_uploads if u.get('power_word') == filter_power_word]
        
        # ÚˆÛŒÙ¹Ø§ Ù¹ÛŒØ¨Ù„
        if filtered_uploads:
            df_data = []
            for upload in reversed(filtered_uploads[-100:]):  # Ø¢Ø®Ø±ÛŒ 100 Ø±ÛŒÚ©Ø§Ø±ÚˆØ²
                df_data.append([
                    upload.get('filename', 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…'),
                    HelperFunctions.format_file_size(upload.get('size', 0)),
                    upload.get('power_word', 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…'),
                    upload.get('timestamp', 'Ù†Ø§Ù…Ø¹Ù„ÙˆÙ…'),
                    "âœ…" if upload.get('status') == 'success' else "âŒ",
                    upload.get('developer', DeveloperInfo.NAME)
                ])
            
            df = pd.DataFrame(
                df_data,
                columns=['ÙØ§Ø¦Ù„ Ù†Ø§Ù…', 'Ø³Ø§Ø¦Ø²', 'Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ', 'ÙˆÙ‚Øª', 'Ø³Ù¹ÛŒÙ¹Ø³', 'ÚˆÙˆÛŒÙ„Ù¾Ø±']
            )
            
            st.dataframe(
                df,
                use_container_width=True,
                hide_index=True,
                column_config={
                    "Ø³Ù¹ÛŒÙ¹Ø³": st.column_config.TextColumn(width="small")
                }
            )
            
            # CSV Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹
            csv = df.to_csv(index=False, encoding='utf-8-sig')
            st.download_button(
                label="ğŸ“Š CSV Ø§ÛŒÚ©Ø³Ù¾ÙˆØ±Ù¹ Ú©Ø±ÛŒÚº",
                data=csv,
                file_name=f"mazari_history_{datetime.now().strftime('%Y%m%d')}.csv",
                mime="text/csv",
                use_container_width=True
            )
    
    def analytics_tab(self):
        """ØªØ¬Ø²ÛŒÛ Ù¹ÛŒØ¨ Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        st.markdown("### ğŸ“ˆ ØªØ¬Ø²ÛŒØ§Øª Ø§ÙˆØ± Ø±Ù¾ÙˆØ±Ù¹Ø³")
        
        if st.session_state.stats['total_uploads'] == 0:
            st.info("ğŸ“Š ØªØ¬Ø²ÛŒÛ Ú©Û’ Ù„ÛŒÛ’ ÚˆÛŒÙ¹Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº ÛÛ’Û” Ù¾ÛÙ„ÛŒ ÙˆÛŒÚˆÛŒÙˆ Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº!")
            return
        
        DashboardComponents.create_stats_cards()
        DashboardComponents.create_analytics_charts()
        
        # ØªÙØµÛŒÙ„ÛŒ ØªØ¬Ø²ÛŒÛ
        col1, col2 = st.columns(2)
        
        with col1:
            st.markdown("#### ğŸ“Š Ú©Ø§Ø±Ú©Ø±Ø¯Ú¯ÛŒ Ú©Û’ Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø´Ù…Ø§Ø±")
            perf_data = {
                'Ù…ØªØ±ÛŒÚ©': ['Ú©Ù„ Ø§Ù¾ Ù„ÙˆÚˆØ²', 'Ú©Ø§Ù…ÛŒØ§Ø¨', 'Ù†Ø§Ú©Ø§Ù…', 'Ø§ÙˆØ³Ø· Ø³Ø§Ø¦Ø²'],
                'Ù‚Ø¯Ø±': [
                    st.session_state.stats['total_uploads'],
                    st.session_state.stats['successful'],
                    st.session_state.stats['failed'],
                    HelperFunctions.format_file_size(st.session_state.stats['total_size'] / st.session_state.stats['total_uploads'] if st.session_state.stats['total_uploads'] > 0 else 0)
                ]
            }
            st.dataframe(pd.DataFrame(perf_data), use_container_width=True, hide_index=True)
        
        with col2:
            st.markdown("#### ğŸ¯ Ù¾Ø§ÙˆØ± ÙˆØ±Úˆ ØªØ¬Ø²ÛŒÛ")
            if st.session_state.uploads:
                power_words = [u.get('power_word') for u in st.session_state.uploads if u.get('power_word')]
                if power_words:
                    from collections import Counter
                    word_counts = Counter(power_words)
                    top_5 = dict(word_counts.most_common(5))
                    
                    fig = go.Figure(data=[go.Pie(
                        labels=list(top_5.keys()),
                        values=list(top_5.values()),
                        hole=.3
                    )])
                    fig.update_layout(title="Ø³Ø¨ Ø³Û’ Ù…Ù‚Ø¨ÙˆÙ„ Ù¾Ø§ÙˆØ± ÙˆØ±ÚˆØ²")
                    st.plotly_chart(fig, use_container_width=True)
    
    def info_tab(self):
        """Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù¹ÛŒØ¨ Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        st.markdown("### â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§ÙˆØ± Ø³Ù¾ÙˆØ±Ù¹")
        
        DashboardComponents.create_contact_section()
        
        # Ø®Ø¯Ù…Ø§Øª
        st.markdown("---")
        st.markdown("### ğŸ› ï¸ Ù¾ÛŒØ´ Ú©ÛŒ Ø¬Ø§Ù†Û’ ÙˆØ§Ù„ÛŒ Ø®Ø¯Ù…Ø§Øª")
        
        services = [
            {"icon": "ğŸ¬", "title": "Ù¾ÛŒØ´Û ÙˆØ±Ø§Ù†Û ÙˆÛŒÚˆÛŒÙˆ Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯", "desc": "Ø§Ø¹Ù„ÛŒÙ° Ù…Ø¹ÛŒØ§Ø± Ú©ÛŒ ÙˆÛŒÚˆÛŒÙˆ Ø§ÛŒÚˆÛŒÙ¹Ù†Ú¯ Ø§ÙˆØ± Ù¾Ø±ÙˆØ³ÛŒØ³Ù†Ú¯"},
            {"icon": "ğŸ“ˆ", "title": "YouTube Ú†ÛŒÙ†Ù„ Ù…ÛŒÙ†Ø¬Ù…Ù†Ù¹", "desc": "Ù…Ú©Ù…Ù„ YouTube Ú†ÛŒÙ†Ù„ Ú©ÛŒ Ø¯ÛŒÚ©Ú¾ Ø¨Ú¾Ø§Ù„ Ø§ÙˆØ± ØªØ±Ù‚ÛŒ"},
            {"icon": "ğŸ¯", "title": "ÚˆÛŒØ¬ÛŒÙ¹Ù„ Ù…Ø§Ø±Ú©ÛŒÙ¹Ù†Ú¯", "desc": "Ù…ÙˆØ«Ø± ÚˆÛŒØ¬ÛŒÙ¹Ù„ Ù…Ø§Ø±Ú©ÛŒÙ¹Ù†Ú¯ Ø³Ù¹Ø±ÛŒÙ¹ÛŒØ¬ÛŒØ²"},
            {"icon": "ğŸ’»", "title": "Ú©Ø³Ù¹Ù… Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± ÚˆÙˆÛŒÙ„Ù¾Ù…Ù†Ù¹", "desc": "Ø§Ù¾Ù†ÛŒ Ø¶Ø±ÙˆØ±ÛŒØ§Øª Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚ Ø³Ø§ÙÙ¹ ÙˆÛŒØ¦Ø± Ø­Ù„"},
            {"icon": "ğŸ¤–", "title": "Ø¢Ù¹ÙˆÙ…ÛŒØ´Ù† Ø³ÙˆÙ„ÙˆØ´Ù†Ø²", "desc": "Ú©Ø§Ø±ÙˆØ¨Ø§Ø±ÛŒ Ø¹Ù…Ù„ Ú©ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ú©Ø§Ø±ÛŒ"},
            {"icon": "ğŸ“Š", "title": "ÚˆÛŒÙ¹Ø§ ØªØ¬Ø²ÛŒØ§Øª", "desc": "ÚˆÛŒÙ¹Ø§ ÚˆØ±Ø§Ø¦ÛŒÙˆÙ† ÚˆÛŒØ³ÛŒÚ˜Ù† Ø¨Ù†Ø§Ù†Ø§"}
        ]
        
        cols = st.columns(3)
        for idx, service in enumerate(services):
            with cols[idx % 3]:
                st.markdown(f"""
                <div class="custom-card">
                    <div style="font-size: 2rem; text-align: center;">{service['icon']}</div>
                    <h4 style="text-align: center;">{service['title']}</h4>
                    <p style="text-align: center; font-size: 0.9rem;">{service['desc']}</p>
                </div>
                """, unsafe_allow_html=True)
        
        # Ø±Ø§Ø¨Ø·Û ÙØ§Ø±Ù…
        st.markdown("---")
        st.markdown("### ğŸ“ ÙÙˆØ±ÛŒ Ø±Ø§Ø¨Ø·Û ÙØ§Ø±Ù…")
        
        with st.form("contact_form"):
            col1, col2 = st.columns(2)
            with col1:
                name = st.text_input("Ø¢Ù¾ Ú©Ø§ Ù†Ø§Ù…")
                email = st.text_input("Ø§ÛŒ Ù…ÛŒÙ„ Ø§ÛŒÚˆØ±ÛŒØ³")
            with col2:
                phone = st.text_input("ÙÙˆÙ† Ù†Ù…Ø¨Ø±")
                service_type = st.selectbox("Ø®Ø¯Ù…Øª Ú©ÛŒ Ù‚Ø³Ù…", services, format_func=lambda x: x['title'])
            
            message = st.text_area("Ù¾ÛŒØºØ§Ù…", height=150)
            
            submitted = st.form_submit_button("ğŸ“¤ Ù¾ÛŒØºØ§Ù… Ø¨Ú¾ÛŒØ¬ÛŒÚº")
            if submitted and name and message:
                st.success(f"âœ… Ø´Ú©Ø±ÛŒÛ {name}! Ø¬Ù„Ø¯ ÛÛŒ Ø¢Ù¾ Ø³Û’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº Ú¯Û’Û”")
    
    def create_footer(self):
        """ÙÙ¹Ø± Ø¨Ù†Ø§ØªØ§ ÛÛ’"""
        st.markdown("---")
        st.markdown(f"""
        <div class="footer">
            <h3>{DeveloperInfo.COMPANY}</h3>
            <p>{DeveloperInfo.TAGLINE}</p>
            <div style="display: flex; justify-content: center; gap: 3rem; margin: 2rem 0; flex-wrap: wrap;">
                <div>
                    <strong>ğŸ“ Ø±Ø§Ø¨Ø·Û</strong><br>
                    {DeveloperInfo.WHATSAPP}<br>
                    {DeveloperInfo.EMAIL}
                </div>
                <div>
                    <strong>ğŸ‘¨â€ğŸ’¼ ÚˆÙˆÛŒÙ„Ù¾Ø±</strong><br>
                    {DeveloperInfo.NAME}<br>
                    {DeveloperInfo.ADDRESS}
                </div>
                <div>
                    <strong>ğŸ“Š Ø§ÛŒÙ¾ Ø§Ø³Ù¹ÛŒÙ¹Ø³</strong><br>
                    {st.session_state.stats['total_uploads']} Ú©Ù„ Ø§Ù¾ Ù„ÙˆÚˆØ²<br>
                    {HelperFunctions.format_file_size(st.session_state.stats['total_size'])} ÚˆÛŒÙ¹Ø§
                </div>
            </div>
            <hr style="opacity: 0.3; width: 50%; margin: 1rem auto;">
            <p style="font-size: 0.9rem; opacity: 0.8;">
                Â© {datetime.now().year} {DeveloperInfo.COMPANY} - ØªÙ…Ø§Ù… Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ ÛÛŒÚº<br>
                ÛŒÛ Ø§ÛŒÙ¾ Ø´Ø§ÛØ¯ Ø§Ø­Ù…Ø¯ Ù…Ø²Ø§Ø±ÛŒ Ù†Û’ ÚˆÙˆÛŒÙ„Ù¾ Ú©ÛŒ ÛÛ’ | ÙˆØ±Ú˜Ù† 3.0.0
            </p>
        </div>
        """, unsafe_allow_html=True)
    
    def run(self):
        """Ø§ÛŒÙ¾ Ú†Ù„Ø§ØªØ§ ÛÛ’"""
        # ÛÛŒÚˆØ±
        DashboardComponents.create_header()
        
        # Ø³Ø§Ø¦ÛŒÚˆØ¨Ø§Ø±
        self.create_sidebar()
        
        # Ù¹ÛŒØ¨Ø²
        tab1, tab2, tab3, tab4 = st.tabs([
            "ğŸ“¤ Ø§Ù¾ Ù„ÙˆÚˆ ÙˆÛŒÚˆÛŒÙˆ", 
            "ğŸ“œ ØªØ§Ø±ÛŒØ®", 
            "ğŸ“ˆ ØªØ¬Ø²ÛŒØ§Øª", 
            "â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª"
        ])
        
        with tab1:
            self.upload_tab()
        
        with tab2:
            self.history_tab()
        
        with tab3:
            self.analytics_tab()
        
        with tab4:
            self.info_tab()
        
        # ÙÙ¹Ø±
        self.create_footer()
        
        # Ù„Ø§Ú¯ Ù¾ÛŒØºØ§Ù…
        logger.info(f"App accessed - Developer: {DeveloperInfo.NAME}")

# ==================== Ø§ÛŒÙ¾ Ú©Ø§ Ø¢ØºØ§Ø² ====================
if __name__ == "__main__":
    try:
        app = MazariYouTubeUploader()
        app.run()
        
        # Ø§ÙØªØªØ§Ø­ÛŒ Ù¾ÛŒØºØ§Ù…
        logger.info("=" * 50)
        logger.info(f"MAZARI YOUTUBE UPLOADER PRO STARTED")
        logger.info(f"Developer: {DeveloperInfo.NAME}")
        logger.info(f"Contact: {DeveloperInfo.WHATSAPP}")
        logger.info(f"Email: {DeveloperInfo.EMAIL}")
        logger.info("=" * 50)
        
    except Exception as e:
        st.error(f"âŒ Ø§ÛŒÙ¾ Ø´Ø±ÙˆØ¹ Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ: {str(e)}")
        logger.error(f"App startup error: {e}")
